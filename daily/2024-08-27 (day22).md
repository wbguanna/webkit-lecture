제발 과제 새로 만들어서 하자..



![[Pasted image 20240827114355.png]]
들어갈때마다 매번 불러오기 때문에 새로 초기화 시켜줘야한다...


직장생활..
실력이 없는데 직장에 들어간다?
결국 아부..? 입에발린말..


일단 

``` node

app.get("/todo/modify", async (req, res) => {
  // const testTodo = {
  //   _id: "66cd36c65a84a8de93f074c7",
  //   title:"테스트임당",
  //   done:false
  // }
  // res.render("todolist/TodoModify", {testTodo});
  // res.render("todolist/TodoModify", {});

  try {
    await client.connect();
    const database = client.db(dbName);
    const collection = database.collection(collectionName);

    // 실제 mongoDB에 저장되는 것은 단순 해시문자열이 아니라
    // ObjectId 객체다..
    const query = { _id: new ObjectId(req.query._id) };
    const todo = await collection.findOne(query);
    console.log("Fetched document:", todo);
    res.render("todolist/TodoModify", { todo });
  } finally {
    await client.close();
  }
});

```


``` node
app.post("/todo/modify", async (req, res) => {
  try {
    await client.connect();
    const database = client.db(dbName);
    const collection = database.collection(collectionName);

    // 실제 mongoDB에 저장되는 것은 단순 해시문자열이 아니라
    // ObjectId 객체다..
    const filter = { _id: new ObjectId(req.query._id).toHexString() };
    const option = { upsert: true };
    const doneRequest = req.body.done == "true" ? true : false;
    const updateDoc = {
      $set: {
        title: req.body.title,
        done: doneRequest,
      },
    };
    const fetch = await collection.updateOne(filter, updateDoc, option);
    console.log("Fetched document:", fetch);
    // res.render(");
    res.redirect("/todo/list");
  } catch (e) {
    console.dir(e);
  } finally {
    await client.close();
  }
});
```


![[Pasted image 20240827140220.png]]


자바 예습..


tnr