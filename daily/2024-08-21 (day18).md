실제 돌아가는 것을 확인하려면 공식문서 확인하는 것(1차벤더..)

Nodejs 전부 알기는 힘들겠지만 책보고 하나 만들 수 있는정도로..
이론4 : 실습6

카페관련 url 알리는 건 검지검지

Node js? #다시보기
원래 js는 웹브라우저에서만 돌아가지요..

애플->구글
삼성->네이버
요런식으로.. 구글개발자들이 원래프로젝트에서 더 나아가서 건드림

제약사항 때문에
브라우저 기준으로 js엔진 구성 => js v8엔진 #다시보기
인터프리터 언어 (LISP, AI) : 모양은 자바같은데 내부적으로는 LISP
js 와 R은 닮았다..

- 모듈과 패키지
- 비동기 입출력
- 이벤트 기반 입출력

2000~2010 : 객체지향형 언어
2010~ : 함수형 언어


js 콜백함수에 대한 이해 #다시보기 
객체만 참조하는 것이 아니라 함수도 참조가능하다..

``` js
task1(a, b, function(err, result) {
	task2(c, function(err, result2) {
		task3(d, function(err, result3) {
			task4(e,f, function(err, result4) {
				// 비동기 동작
			});

		});
	});
});
```
대충 표시하려고 한것이겠지만


콜백함수를 없애는 법?
Promise #다시보기 
비동기 동작 흐름제어
js ES6 (Node.js 4.x 버전이후... 2018년, 내가 입학했을때쯤 생김)

Promise의 상태
pending
fullfilled
rejected

Promise 를 쓰려는 이유는 분기의 순서를 정해 주기 위해서 쓰는 거임..
if문으로 쓰면 

``` js 
/ex01_promise.js
function task1(fulfill, reject) {
  console.log("1. Task1 시작");
  let num = 0;
  setTimeout(function () {
    num = 1004;
    fulfill("Task1 결과", num);
  }, 300);
  console.log("2. Task1 끝", num);
}

function fullfilled(result, num) {
  console.log("fullfilled 함수", result, num);
}

function rejected(err) {
  console.log("rejected : ", err);
}

new Promise(task1).then(fullfilled, rejected);

```


Promise를 상속받아 만드는 경우도 있다
실습은 하지 않지만 알아두자


``` js
/ex02_promise
new Promise((fulfill, reject) => {
  console.log("1. Task1 시작");
  let num = 0;
  //1 번
  setTiemout(function(){
  setTimeout(() => {
    num = 1004;
    fulfill("Task1 결과", num);
    // 여기서 this 라면
	console.log(this); // 1
  }, 300);
  console.log("2. Task1 끝", num);
})
//2
.then(funciton(result){
//.then((result) => { // 화살표함수
  console.log("fullfilled 함수 : ", result.data, result.num);
  console.log(this); // 2
});
```

1, 2 화살표 함수라면 : console.log(this) 는 {} 출력
일반 함수라면? : 
![[Pasted image 20240821102430.png]]
Timeout의 this는 Timeout 이지만
fullfilled 함수의 this는 nodejs 의 최상위 객체인 Object \[global\] 에 등록된다


axios 같은 ajax 방식이라면 읽어오기전에 변수를 참조할때 에러가 생길 수 있다..


/ex03_promise.js : Promise는 분기처리, 비동기 통신에 대한 방법임
/ex04_promise.js : Promise 비교용 callbalck ?


HTTP #다시보기 
HTTP 헤더 몇가지와 동작방식을 조금 이해해야한다.
(ex- Content-Type )
Nodejs20v -Http 공식문서 : https://nodejs.org/docs/latest-v20.x/api/http.html

물론 express를 이용하면 빠르게 웹서버를 구축할 수 있지만 HTTP 같이 기본적인 사항을 이용할 수도 있다

Form은 GET, POST 두가지 밖에 되지 않았다..

HTTP 이벤트
- connection
- request
- close

``` js
var http = require("http");

var server = http.createServer();

const port = 3000;

server.on("request", function (request, response) {
  response.end("Hello");
  // console.log(request);
  // response.end("Hello2");
  // console.log(response);
});

server.on("connection", function (session) {
  console.log("connection event", session);
  // console.log(session);
});
server.on("close", function () {
  console.log("close");
});

server.listen(port, () => {
  console.log("http://localhost:3000");
});

```
접속하면 클라이언트에는 Hello가 출력된다

접속한번에 connection 이벤트가 두번 실행되더라..

favicon.ico
![[Pasted image 20240821110701.png]]

요청이 2번 들어가는 이유..


/ex06_http.js  : servlet 처럼
/ex06_1_http.js : 템플릿을 사용해서..



``` js
server.on("request", (req, res) => {
  console.log("클라이언트 요청이 들어왔습니다.");

  res.writeHead(200, { "Content-Type": "text/html; charset=utf-8" });
  res.write(html);
  res.end();
});

```

여기서 
``` js
res.end() 
```

가 한번도 호출되지 않으면 무한루프가 걸릴 수 있담
두번 호출되었다면 예상치 못한 오류가 생길 수 있다

아래는 한번 돌려보고 내가 한 생각이다...(뇌피셜)

브라우저에서 계속 반복
![[Pasted image 20240821112750.png]]
마무리가 안난다..

![[Pasted image 20240821112909.png]]
end 두번 시에는 너무 일찍 끝나게 되고
![[Pasted image 20240821112956.png]]
시크릿창이 요청받고 완료되지 못했지만 동시에 완료되지 않았던 브라우저가 완료된 파일 받는다?


파일 다루기 #다시보기
동기식 IO/ 비동기식 IO 함께 제공한다..
Sync: 동기식 IO방식에 붙는다

``` js
readFile(filename, [encoding], [callback]) // 비동기식 IO 파일 읽기
readFileSync(filename, [encoding])         // 동기식 IO 읽기
writeFile(filename, [encoding], [callback]) // 비동기식 IO 파일 쓰기
writeFileSync(filename, [encoding])         // 동기식 IO 쓰기
```

뭔가 기능이 고급스럽다면.. 파일IO가 적용된것

브라우저.. 에서 파일IO 사용가능할까? permission이 있다..
NodeJS 잘 활용하며는 해킹툴 만들기도 불가능하진 않다..?ㅋㅋ


한줄로 파일 입출력 가능한 갓Node



상담 다녀와서 13:40분 도착
41p~55p


view engine 속성 #다시보기 
- view-engine 은 템플릿을 설정하는 방식
- 화면을 꾸미는 것이지만 실제로 서버에서 실행되는 코드다..!!
- ejs (jsp 랑 많이 비슷함), pug 같은것도 사용
- ejs는 언더스코어 라이브러리의 템플릿과 비슷한 구조임

우린 다음주에 JSP 나감...ㅋㅋ...

미들웨어.. 만들어서 사용할 수도 있긴함..
만들어진 것/만든 것을 모듈별로 나눌 수 있을정도..?
ex) cors

미들웨어 #다시보기 
중간에 
app.use((req, res, next)=>{})
next를 추가해  필터 역할을 할 수 있다..


요청객체 추가 및 파라미터 #다시보기 


body-parser를 이용한 post 처리 #다시보기 

**![](https://lh7-rt.googleusercontent.com/slidesz/AGV_vUfj6V0trSKnnozFlMonVwQ1V1v-P3MQKfJem5t6uSEqpFohdo6rqqEeog68xlMvEPZojgooFrGA_qIuBrF-NzJSyqOgbw7IbfYfTVAcA2hJDS2nzeyuZt3Vts5NqnOiUKjQbh1hRGPQQxbdFEpk_4FsO5wH-BsFV3ov1w0_x3ltbA=s2048?key=eELyIObwZKcQmgbo6d-xmw)**

그림에서 나타나는 요구사항 (crud, 여러개)
1. create,1 - 새사원추가
2. read, \* - 검색기능 (이름,부서,직급 등)
3. update, 1 - 사원 정보 수정
	- 수정할때 modal로 표시되어야 한다
4. delete, 1 - 사원 한명 삭제
5. delete, \* - 사원 선택삭제
+ footer / header는 알아서..


