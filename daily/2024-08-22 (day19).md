
cors?


### 실습: 또 관리페이지 만들기...
- 프로젝트 설정
	- 프로젝트 폴더구조 관리
	- express url 관리
- 멤버 로그인/회원가입 페이지 작성 (post, bodyParser)


![[Pasted image 20240822094420.png]]
- public : 서버에서 정적으로 전달 할 것.  이미지, favicon 등의 자료들을 넣는다
	- resources : 이미지 파일등을 넣는다
- views : 실제 동적으로 제공할 페이지들이 들어가는 디렉토리
	- inc : 동적인 페이지들 중 반복적으로 들어가는 것들을 넣는다
	- header, footer 와 같이 고정적으로 들어가는 디렉토리
``` node.js
const http = require("http");
const express = require("express");
const app = express();

app.set("port", 3000);
app.set("views", path.join(__dirname, "views")); // 절대경로 // 작업디렉토리가 바뀐다면 이게 나을 수 있음
app.set("views", "views"); // 상대경로 // 보안?
app.set("view engine", "ejs");

app.use(express.static("public")); // public 폴더 정적 제공

app.get("/hong", (req, res) => {
  req.app.render("Home", {}, (err, html) => {
    res.end(html);
  });
});

const server = http.createServer(app);
server.listen(app.get("port"), () => {
  console.log(``); // 최신문법 쓸때는 호환이 되ㅡㄴ지 확인해보자
});

```


웹에서 최신기술 ex) ES2015 (\`\`, ()=>{}) 쓸 떄는 크로스 브라우징등
예전에 만들어진 것과 호환되는지를 고려하자..

홀수버전 안쓴다? (윈도우즈?)


ejs 에서 다른 view를 포함하려면

``` ejs
<%-include('./inc/Top.ejs') %>
```

- 질문사항
	- 이은총 : 강사님 include 방식으로 js랑 css로 불러낼 수 있나요?
	- 나 : 그럼 link로 css, js 파일을 추가하면 node에서 같이 전달하는 건가요?
	- 클라이언트는 url로 node에 파일을 요청하거나 한꺼번에 받거나
	- 다만 그 url의 node(서버)가 인가를 하느냐의 차이다..

개발자..? 써먹어야 된다...
학자..? 계속 공부해야됨 학문?

얼리어답터? 최신기술 공부하고.. 학위를 따라?
나만 알아주세요? 그건 좀 맞아야지 
근데 뭐 반응안하면 안한다고 뭐라 할꺼잖아..
질문 이상해도 답변하기도 싫은거고

페이지 안에서 



![[Pasted image 20240822104219.png]]

요런 폴더 구조에서

![[Pasted image 20240822104250.png]]

나중에 확장할 것을 생각해서 이렇게 바꾼다..

그러면 연결된 문서들의 위치를 다시지정해줘야 한다
여기서는 app.js와 각 파이의 inc를 변경했다

이렇게 하는 이유는 확장성을 생각해서 미리 분리 시켜놓는다


객체를 




설치할때는 실행되는 것을 종료하자
좋은 습관이 좋은 운명을 만든다..!

``` html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <%-include('../inc/Top.ejs')%>
    <div class="container">
      <table class="table">
        <tr>
          <th>ID</th>
          <td><input type="text" name="userid" value="user01" /></td>
          <td rowspan="2"><a href="/login" class="btn btn-primary">로그인</a></td>
        </tr>
        <tr>
          <th>비밀번호</th>
          <td><input type="password" name="userpw" value="1234" /></td>
        </tr>
      </table>
    </div>
  </body>
</html>
```

input 에다가 value를 미리 넣어서 테스트 한다

그런데 여기서 잘못된 점이 뭐가 있을까?
a tag는 get 요청만 보낸다고 한다..
https://stackoverflow.com/questions/6180256/post-from-an-a-tag

그러면 이제 button 또는 input으로 고쳐줘야 post submit이 가능하다
```html
			<a href="/login" class="btn btn-primary">로그인</a>
			<!-- 위에서 아래로네 -->
            <input type="submit" class="btn btn-primary">로그인</input>
```



router
``` node
	var router = express.Router();
	router.route(요청패스).get(실행 될 함수);
	router.route(요청패스).post(실행 될 함수);

	// 라우터 설정이 모두 끝나면 미들웨어 등록.
	app.use('/', router);
```


오류페이지 보여주기 #다시보기 

쿠키 처리하기 #다시보기

세션은 쿠키를 이용한다..
로그인 정보등 관련 정보를 쿠키에다 저장하는 방식

```js
      const cookieData = decodeURIComponent(document.cookie);
      // 실제 저장된 쿠키값
	  // j:{"id":"TestUser","name":"테스트 유저","authorized":true}
      // console.dir(JSON.parse(cookieData.split("j:")));
      const cookieObj = JSON.parse(cookieData);
```


![[Pasted image 20240822142220.png]]

이렇게 날라오는 것을 쿠키를 직접 다뤄줘야 한다


w3s 라면
![[Pasted image 20240822142418.png]]
![[Pasted image 20240822142455.png]]
요런식으로 관리하는게 따로 있는 것 같다


아래는 w3s 예제다
``` js
// https://www.w3schools.com/js/js_cookies.asp
function getCookie(cname) {  
  let name = cname + "=";  
  let decodedCookie = decodeURIComponent(document.cookie);  
  let ca = decodedCookie.split(';');  
  for(let i = 0; i <ca.length; i++) {  
    let c = ca[i];  
    while (c.charAt(0) == ' ') {  
      c = c.substring(1);  
    }  
    if (c.indexOf(name) == 0) {  
      return c.substring(name.length, c.length);  
    }  
  }  
  return "";  
}
```


진짜 개발 왜하냐 ㅋㅋ 
아마존 부족민들도 폰켜고 웹사이트 쓴다
개발자들은 밥은 먹고 산다..? 과연..?
건대 마라탕 메카ㅋㅋㅋ
탕탕후루후루 탕탕후루루룰루ㅜ



세션 로그인 로그아웃 설정 #다시보기
spring security?


express 에서 cors 모듈을 쓰지 않을때
``` js
/* Cross Domain 문제 해결 - CORS 모둘 대신 사용 가능 */
app.use(function(req, res, next) {
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Headers", "Origin, X-Requested-With, Content-Type, Accept");
    next();
});
```
요런 식으로도 가능은 하다..
포트번호조차 구분한다..

MVC 패턴 #다시보기
패턴 남발하면 안쓰니만 못하다..
각각에 CRUD가 적용되지..

한페이지에 대한 정보가 너무 방대하다면  MSA로도 처리하기도 한다..
의미가 있을진 몰라도

우리는 MVC 모델 참맛을 느끼기 위해서 ejs를 적극사용한다 (react 가세요라)

3시 35분 shop 페이지 설명

ejs 로 /shop 아래 페이지 구현하기 #다시보기

스터디를 시작해라


이제 java-webserver 만들테니까
자바 컬렉션, 상속, 다형성, JDBC(+jpa) 등등...
특히 자료구조 잘해야 함...



  

쇼핑몰 상품 목록 #다시보기 

// 몽고 db 에서는 primary key를 id
// row 라고 안하고 document라고 한다..
// 여기서 carList 는 컬렉션이라고 말한다..
// 물리적 단계? 논리적 단계로 넘어가서 쓸 수 있다..


socket.io : 원래 node.js 내부 모듈이었지만 분리됨
내일 당장 socket.io / mongodb 같이 쓸 예정이다..
프로젝트를 라즈베리파이 이용해서도 쓸 수 있다... (리눅스데이터시스템...)


